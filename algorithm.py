def convert_hex_to_ascii(h):
    chars_in_reverse= []
    while h != 0x0:
        chars_in_reverse.append(chr(h & 0xff))
        h = h >> 8

    chars_in_reverse.reverse()
    return ''.join(chars_in_reverse)


def egcd(a, b):
    x, y, u, v = 0, 1, 1, 0
    while a != 0:
        q, r = b//a, b%a
        m, n = x-u*q, y-v*q
        b,a,x, y, u, v = a, r, u, v, m, n
        gcd = b
    return gcd, x, y

def main():
    n = 21234242752160690711606271275100123565814303893902978204554894818224377419642100458427096570608275719603819561411567383744949866653361020382702730221238531880230803031416880115325560679610014544259003323312617772747682618895845669130769766543881076570608187753555596046279379789057398298275115779576400224100525582237921802699588664536461059868515686509778851506043148252732755401381041956700233549929556017817340317320856579038574089557243044056294234133810839366951516046930739109456382385612892828737281164882111346224700127666352423791080977112976855173678050243104656929960107122946385688747829008641797815748149
    p =[136159615458900134746511421586032499176688309023605950196434107493048382647785373299687846287220505223685885574794671649052256059332765544244055280786670110439965094586977205504738970063673401024702774018653256879300485628972829614033134276826837030475238240904338451196177218445394106426872069610542253922119, 155951106946025858843735650545513053402568328341383387411466769066662457029231264400625263569129037383576656634101917193983042394695355564577566265153726459998828754893080257825964244182007979610535935247011102619887120039639156977212163652642919198580872307548343087358682842211775633849224881975622487518371]
    # p = []
    e = 65537
    ct = 6273901146258372719491065115948150065394918199188542799986545416944612697663935350491165585151328119647484324010128896797436989374919779597073383862377853068293360601160474954352369504939852111949184459355501981042801769053223754877141972789638190916724538551836930369672580290209964153193585386375183542508361177630232434735903585124512281472483603782471831876637152096043881852894615471934262853250925810028216519501313542299688555168100062979371496584988257573605943736816028812231815239129736067370293829044198711978704039606319380545673170978152932701903860860244612452544836410411409375235433927441982773550811

    phi = 1
    for i in range(len(p)):
        phi *= (p[i] - 1)

    gcd, a, b = egcd(e, phi)
    d = a
    print("d:  " + str(d) )

    pt = pow(ct, d, n)
    print("pt:  " + str(convert_hex_to_ascii(pt)))

main()
